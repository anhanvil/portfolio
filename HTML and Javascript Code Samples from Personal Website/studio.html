<!DOCTYPE html >
<html>
<head>
	<meta charset="utf-8" />
	<title>Final Studio Piece</title>
	<link href="../css/styles.css" rel="stylesheet" type="text/css">
	<style>
		img {width:12em; height:18em;}
		#gamespace {width:70em;}
		.cards {float:left;}
		h1 {font-family:"Arial"}
		#cssmenu {float:left;margin-bottom:40em;margin-right:1em;}
		body {background-image:url('../images/scifiscene.bmp'); background-size: cover; background-repeat: no-repeat;}
		.footer {bottom:0px;position:absolute;text-align:center;padding:.25em;background-color:black;color:white;border-radius:.5em;}
	</style>
<script>
	var count=30;
	var counter=setInterval(timer, 1000);

	var turns;
	turns = 0;
	var firstchoice;
	var secondchoice;
	var cntr = 0;
	var backcard = "../images/cardback.jpg";
	var faces = new Array(
		'../images/spades.png', '../images/hearts.png', '../images/clubs.png', '../images/clubs.png', 
		'../images/spades.png', '../images/hearts.png', '../images/diamonds.jpg', '../images/diamonds.jpg');
	var numOfMatches = .5*faces.length;
	var tid;
	
	var wins;
	var losses;
	var newWins;
	var newLosses;
	
	function choose(card) {
		if (turns==2) { return ;}
		if (turns==0) {
			firstchoice=card;
			document.images[card].src = faces[card];
			turns = 1;
		}
		else { 
			turns = 2;
			secondchoice = card;
			document.images[card].src =faces[card];
			tid=setInterval("check()",1000);
		}
	}

	function check() {
		clearInterval(tid);
		if (faces[secondchoice]==faces[firstchoice]) {
			cntr++;
			if (cntr == numOfMatches) {
				newWins++;
				setCookie("wins",newWins,30);
				alert("You won!! Reload/Refresh to play again ...");
				checkCookie();
			}
			turns = 0;
			return ;
		}
		else {
			document.images[firstchoice].src = backcard;
			document.images[secondchoice].src = backcard;
			turns = 0;
			return ;
		}
	}
	
	function shuffle() {
		var holder;
		var swaps;
		var i;
		var j;
		for (swaps=0; swaps<12; swaps++) {
			i = Math.floor(Math.random()*faces.length);
			j = Math.floor(Math.random()*faces.length);
			holder = faces[i];
			faces[i] = faces[j];
			faces[j]=holder;
		}
	}
	
	function timer() {
		count=count-1;
		if (count <= 0 && (cntr != numOfMatches)) {
			clearInterval(counter);
			count = 0;
			newLosses++;
			setCookie("losses",newLosses,30);
			alert("You lost!! Reload/Refresh to play again ...");
			checkCookie();
			return;
		}
		if (count <=0) {
			count = 0;
		}
		document.getElementById("timer").innerHTML= count + " second(s) left!";
	}
	
	function getCookie(c_name) {
		var i,x,y,ARRcookies=document.cookie.split(";");
		for (i=0;i<ARRcookies.length;i++) {
			x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));
			y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);
			x=x.replace(/^\s+|\s+$/g,"");
			if (x==c_name) {
				return unescape(y);
			}
		}
	}

	function setCookie(c_name,value,exdays) {
		var exdate=new Date();
		exdate.setDate(exdate.getDate() + exdays);
		var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
		document.cookie=c_name + "=" + c_value;
	}

	function checkCookie() {
		newWins=getCookie("wins");
		newLosses=getCookie("losses");
		var score= "Wins: " + newWins + "   Losses: " + newLosses;
		if ((newWins!=null && newWins!="") && (newLosses!=null && newLosses!="")) {
			alert(score);
		}
		else {
			wins = 0;
			losses = 0;  
			setCookie("wins",wins,30);
			setCookie("losses",losses,30);
		}
		newWins=getCookie("wins");
		newLosses=getCookie("losses");
	}
</script>
</head>
<body onload="checkCookie()">
	<div class = "heading">
		<h1>Final Studio Piece</h1>
	</div>
	<div id='cssmenu'>
	<ul>
		<li class='active'><a href='index.html'><span>Home</span></a></li>
		<li><a href='3Dmodels.html'><span>3D Models</span></a></li>
		<li><a href='animations.html'><span>Animations</span></a></li>
		<li><a href='studio.html'><span>Final Studio Piece</span></a></li>
		<li><a href='aboutme.html'><span>About Me</span></a></li>
		<li class='last'><a href='contact.html'><span>Contact</span></a></li>
	</ul>
	</div>
<div id="gamespace">
	<div class="shuffle">
		<a href="javascript:shuffle()">Shuffle cards</a>
	</div>
	<div id="countdown">
		<span id="timer"></span>
	</div>
	<div class="cards">
		<a>
			<img src="../images/cardback.jpg" onclick="choose(0)" />
		</a>
	</div>
	<div class="cards">
		<a>
			<img src="../images/cardback.jpg" onclick="choose(1)" />
		</a>
	</div>
	<div class="cards">
		<a>
			<img src="../images/cardback.jpg" onclick="choose(2)" />
		</a>
	</div>
	<div class="cards">
		<a>
			<img src="../images/cardback.jpg" onclick="choose(3)" />
		</a>
	</div>
	<div class="cards">
		<a>
			<img src="../images/cardback.jpg" onclick="choose(4)" />
		</a>
	</div>
	<div class="cards">
		<a>
			<img src="../images/cardback.jpg" onclick="choose(5)" />
		</a>
	</div>
	<div class="cards">
		<a>
			<img src="../images/cardback.jpg" onclick="choose(6)" />
		</a>
	</div>
	<div class="cards">
		<a>
			<img src="../images/cardback.jpg" onclick="choose(7)" />
		</a>
	</div>
</div>
<div class="footer">
		Conor Skatrud, 2013
</div>
</body>
</html>